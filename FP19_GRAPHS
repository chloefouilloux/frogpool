
# FROGPOOL 2019 (ONLY) DATA USED FOR SPECIES COMPARISONS IN 2019. NO DATA HERE IS COMBINED.
# FP 2019 GRAPHING AND MODELS ONLY. 
#########################################################################################

#What is presence by size?
options("scipen"=6)

#First, let's load some packages
library(ggplot2)
library(gridExtra)
library(cowplot)
library(dplyr)
library(tidyverse)
library(corrplot)
library(ggpubr)
library(Hmisc)
###
#For raincloud plot
library(PupillometryR)
library(forcats)

#Now, let's load and tidy up the frogpool 2019 data.

frog<- read.csv("frogpool19.csv", header = T,fileEncoding="UTF-8-BOM") #fromg Andrius

#LET'S TRY THIS UPDATED ONE FROM SEPTEMBER
frog1<- read.csv("frogpool19_v2_reduced_2020-09-03.csv", 
                header = T,fileEncoding="UTF-8-BOM") #from Andrius

head(frog1)

frog1 <- frog1 %>%
         mutate(Total_Tads = tp_femo_hahneli + oophagus_tp + tadpoles_tinc, 
                Tad_Y_N = ifelse(Total_Tads > 0, 1, 0), 
                Tad_Y_N = as.factor(Tad_Y_N), 
                species = ifelse(tp_femo_hahneli> 0, "Femoralis", 
                                 ifelse(oophagus_tp >0, "Oophagus", "Tinctorius")), 
                species = as.factor(species))

#Priority in ifelse given to less sampled species. For example, if tinc and femo occur
#in the same pool, output gives "femo" because we have plenty of tinc data.

frog1$Species <- c("All")

#FROG2 USES NONE AS A CATEGORY WHEN THERE IS 0
frog2 <- frog1 %>%
  mutate(Total_Tads = tp_femo_hahneli + oophagus_tp + tadpoles_tinc, 
         Tad_Y_N = ifelse(Total_Tads > 0, 1, 0), 
         Tad_Y_N = as.factor(Tad_Y_N), 
         species = ifelse(tp_femo_hahneli> 0, "Femoralis", 
                          ifelse(oophagus_tp >0, "Oophagus", 
                                 ifelse(tadpoles_tinc > 0, "Tinctorius", "None"))), 
         species = as.factor(species))

frog2$species<- fct_relevel(pool_terr$Water_Cap, c("Femoralis", "Oophagus", "Tinctorius", "None"))


###############
### SPECIES----
###########
##Now I have to think how to do this for 3 species.
tincpool<- frog1 %>%
          dplyr::select(-oophagus_tp, -tp_femo_hahneli)%>%
          mutate(Tadpoles = tadpoles_tinc,
                  Species = "Tinctorius")%>%
          dplyr::select(height, Tadpoles, Species,
                        pool_type, water_capacity, 
                        leaflit_vol_ml, KH, hardness, no3,
                        salinity, invert_diversity, predator_count,
                        predator_size_sum, amphib_diversity, Total_Tads)%>%
          filter( Tadpoles > 0)


oopool<- frog1 %>%
         dplyr::select(-tadpoles_tinc, -tp_femo_hahneli) %>%
  mutate(Tadpoles = oophagus_tp,
         Species = "Oophagus")%>%
  dplyr::select(height, Tadpoles, Species,
                pool_type, water_capacity, 
                leaflit_vol_ml, KH, hardness, no3,
                salinity, invert_diversity, predator_count,
                predator_size_sum, amphib_diversity, Total_Tads)%>%
  filter( Tadpoles > 0)

femopool<- frog1 %>%
  dplyr::select(-tadpoles_tinc, -oophagus_tp)%>%
  mutate(Tadpoles = tp_femo_hahneli,
         Species = "Femoralis")%>%
  dplyr::select(height, Tadpoles, Species,
                pool_type, water_capacity, 
                leaflit_vol_ml, KH, hardness, no3,
                salinity, invert_diversity, predator_count,
                predator_size_sum, amphib_diversity, Total_Tads)%>%
  filter( Tadpoles > 0)


pools_species<- full_join(tincpool, femopool, 
                          by = c("height", "Species", "Tadpoles", 
                                 "KH", "Total_Tads", "leaflit_vol_ml", 
                                 "salinity", "predator_size_sum", 
                                 "predator_count", "hardness", "pool_type", "water_capacity"))

pools_species<- full_join(pools_species, oopool, 
                          by = c("height", "Species", "Tadpoles", 
                                 "KH", "Total_Tads", "leaflit_vol_ml",
                                 "salinity", "predator_size_sum", 
                                 "predator_count", "hardness", "pool_type","water_capacity")) 

pools_species$Species <- as.factor(pools_species$Species)

table(pools_species$Species)

##Now what if we only consider pools that are terrestrial?
###TERRESTRIAL POOLS ----
######################################

pool_terr <- frog1 %>%
             filter(height < 220) %>%
        mutate(Total_Tads = tp_femo_hahneli + oophagus_tp + tadpoles_tinc, 
         Tad_Y_N = ifelse(Total_Tads > 0, 1, 0), 
         Tad_Y_N = as.factor(Tad_Y_N), 
         Water_Cap = ifelse(water_capacity> 5000, "Large", 
                            ifelse(water_capacity >1000, "Medium", "Small")), 
         Water_Cap = as.factor(Water_Cap),
         species = ifelse(tp_femo_hahneli> 0, "Femoralis", 
                          ifelse(oophagus_tp >0, "Oophagus", "Tinctorius")))

pool_terr$Water_Cap<- fct_relevel(pool_terr$Water_Cap, c("Small", "Medium", "Large"))

range(frog1$water_capacity)

pool_kh<- pool_terr %>%
          filter(KH > 8)
pool_kh_all<- frog1%>%
              filter(KH > 8)
#First thing is first, let's see what variables are correlated.
#################
#CORRELATION----
###############
#Correlation must be numeric so let's just subset the numeric variables.

numfrog<- frog1 %>%
  dplyr::select(- pool_type, - date, - pool_id, - tree, 
                -pH_strip, -Total_Tads, -Tad_Y_N) %>%
  #There is one row in leaflitter that has an NA that I think is giving the correlation plot
  #some trouble. So we are going to go ahead and drop that row. 
  tidyr::drop_na()

#HOW ABOUT FOR TERRESTRIAL POOLS
numfrog_terr<- numfrog %>%
               filter(height <= 220)

#Okay, this plot is a little busy, so let's only show significant correlations
corfrog_sig<- rcorr(as.matrix(numfrog), type = "pearson")
M <- corfrog_sig$r
p_mat<-corfrog_sig$P

corrplot(M, type = "upper", order = "alphabet", method = "number",
         tl.col = "black", tl.srt = 45, number.cex = 0.65, 
         p.mat= p_mat, sig.level = 0.05, 
         insig = "blank")


#Okay, this plot is a little busy, so let's only show significant correlations
corfrog_sig1<- rcorr(as.matrix(numfrog_terr), type = "pearson")
M1 <- corfrog_sig1$r
p_mat1<-corfrog_sig1$P

corrplot(M1, type = "upper", order = "alphabet", method = "number",
         tl.col = "black", tl.srt = 45, number.cex = 0.6, 
         p.mat= p_mat1, sig.level = 0.05, 
         insig = "blank")
?rcorr()
?corrplot ()

##############
# SUBSTRATES ----
###############

#demonstration of pool type segregation, which is captured
#when looking at pool water capacity and leaf litter concentration.
ggplot(frog1, aes(x = pool_type, y= Total_Tads)) + 
  geom_point(size =3, alpha = 0.7, aes(color = species))+
  theme_bw()

################
### HEIGHT ----
###############
#My goodness I love these raincloud plots so fucking much.
#This is with only FP2019 data. Maybe we should combine it with the 2020 data as well.

#Let's relevel to make the graph more intuitive

#FIRST, LET'S GRAPH ALL OF THEM TOGETHER, MEGA PRESENCE/ABSENCE

ggplot(frog1)+
  geom_point(aes(x = height, y = Species, color = Tad_Y_N))+
  theme_bw()+
  theme(legend.position = "none")+
  xlab("Height (cm)")+
  theme(text = element_text(size=14))+
  labs(tag = "A")

fct_relevel(pools_species$Species, "Tinctorius", "Oophagus", "Femoralis")

#NICE MEGA GRAPH

a<-ggplot(pools_species)+
  geom_flat_violin(aes(y = height, x = Species, fill = Species), 
                   position = position_nudge(x = .2, y = 0),
                   alpha = 0.4)+
  geom_point(aes(y = height, x = Species, color = Species), 
             position = position_jitter(width = .15), 
             alpha = 0.6)+
  geom_point(data = frog1, aes(y = height, x = Species, shape = Tad_Y_N), 
             position = position_jitter(width = .3), size = 2.5, 
             alpha = 0.4)+
  theme_bw()+
  ylab("Height (cm)")+
  expand_limits(x = 4) +
  scale_color_manual( values = c("darkgrey", "#ffd16b", "#80e6ff" ))+
  scale_fill_manual( values = c("darkgrey", "#ffd16b", "#80e6ff"))+
  scale_shape_manual(values = c(1, 16), 
                     name = "Tadpole presence", labels = c("No", "Yes"))+
  labs(tag = "A")

a

legend<- get_legend(a)

a<- a + theme(legend.position = "none")

#Just terrestrial pools
b<- ggplot(pools_species, 
       aes(y = height, x = Species))+
  geom_flat_violin(aes(fill = Species), 
                   position = position_nudge(x = .2, y = 0),
                   alpha = 0.4)+
  geom_boxplot(width = .1, aes(fill = Species), 
               outlier.shape = NA, alpha = 0.3) +
  geom_point(aes(y = height, color = Species), 
             position = position_jitter(width = .15), 
             alpha = 0.6)+
  theme_bw()+
  ylim(0, 250)+
  ylab("Terrestrial height (cm)")+
  scale_color_manual( values = c("darkgrey", "#ffd16b", "#80e6ff" ))+
  scale_fill_manual( values = c("darkgrey", "#ffd16b", "#80e6ff"))+
  theme(legend.position = "none")+
  labs(tag = "B")

b
grid.arrange(a,legend, b, ncol = 2, widths = c(2.5,0.45))

?geom_flat_violin
################
### KH ----
###############

ggplot(pools_species, 
       aes(x= KH, y = Total_Tads, color = Species))+
  geom_point(alpha = 0.8, size = 3)+
  stat_smooth(method = "glm", formula = y~ log (x), 
              se = T, fill = "lightgrey", fullrange = F)+
  theme_bw()+ 
  ylim(0, 60)+
  scale_color_manual( values = c("darkgrey", "#ffd16b", "#80e6ff"))

ggplot(pools_species, 
       aes(x= KH, y = height, color = Species))+
  geom_point(alpha = 0.8, size = 3)+
  stat_smooth(method = "glm", formula = y~ (x), 
              se = T, fill = "lightgrey", fullrange = F)+
  theme_bw()+ 
  ylim(0, 1700)+
  scale_color_manual( values = c("darkgrey", "#ffd16b", "#80e6ff"))

#KH AND SALINITY----
ggplot(pools_species, 
       aes(x= KH, y = salinity, color = Species))+
  annotate("rect", xmin = 2, xmax = 7, ymin = 0, ymax = 50,
           alpha = .3, fill = "darkgrey", color= "darkgrey",
           linetype ="dashed")+
  annotate("rect", xmin = 2, xmax = 8, ymin = 100, ymax = 250,
           alpha = .3, fill = "#ffd16b", color= "#ffd16b", linetype =
             "dashed")+
  geom_jitter(size = 3, alpha = 0.4)+
  stat_smooth(method = "glm", formula = y~ log (x), 
              se = T, fill = "lightgrey", fullrange = F)+
  ylim(0, 1000)+
  ylab("Salinity (ppm)")+
  theme_bw()+  
  scale_color_manual( values = c("darkgrey", "#ffd16b", "#80e6ff"))

################
### LEAF LITTER ----
###############

ggplot(pools_species, 
       aes(x= leaflit_vol_ml, y = Total_Tads, color = Species))+
  annotate("rect", xmin = 0, xmax = 1300, ymin = -Inf, ymax = Inf,
           alpha = .3, fill = "#80e6ff")+
  geom_point(alpha = 0.8, size = 3)+
  stat_smooth(method = "glm", formula = y~ poly(x, 1), 
              se = F, fill = "lightgrey", fullrange = F, 
              size = 0.5)+
  ylim(0, 60)+
  ylab("Tadpole Count")+
  xlab("Leaf litter (vol/mL)")+
  theme_bw()+  
  scale_color_manual( values = c("darkgrey", "#ffd16b", "#80e6ff"))

ggplot(pools_species, 
       aes(x= leaflit_vol_ml, y = predator_size_sum, color = Species))+
  stat_smooth(formula = y~ (x), method = "glm",
              se = T, fill = "lightgrey", fullrange = F, 
              size = 0.8)+
  geom_point(alpha = 0.8, size = 3)+
  ylim(0, 150)+
  theme_bw()+  
  geom_vline( xintercept = 1200, linetype = "dashed",
              color = "#80e6ff")+
  geom_vline( xintercept = 50, linetype = "dashed",
              color = "#ffd16b")+
  scale_color_manual( values = c("darkgrey", "#ffd16b", "#80e6ff"))

ggplot(pools_species, 
       aes(y = leaflit_vol_ml, x = Species))+
  geom_boxplot(width = .1, aes(fill = Species), 
               outlier.shape = NA, alpha = 0.3) +
  geom_flat_violin(aes(fill = Species), 
                   position = position_nudge(x = .2, y = 0),
                   alpha = 0.4) +
  geom_jitter(aes(y = leaflit_vol_ml, color = Species), 
             position = position_jitter(width = .15), 
             alpha = 0.6)+
  theme_bw()+
  coord_flip()+
  ylab(" Leaflitter (vol/mL)")+
  scale_color_manual( values = c("darkgrey", "#ffd16b", "#80e6ff" ))+
  scale_fill_manual( values = c("darkgrey", "#ffd16b", "#80e6ff"))+
  theme(legend.position = "none")+
  labs(tag = "C")

#terrestrial pool subst
ggplot(pool_terr, 
       aes(x= leaflit_vol_ml, y = height, color =species))+
  geom_point(alpha = 0.6, size = 3)+
  xlab("Leaf litter (vol/mL)")+
  theme_bw()+  
  geom_hline(yintercept = 75, linetype = "dashed", color = "darkgrey")+
  ylab("Height (cm)")+
  facet_wrap(~ Water_Cap)+
  scale_color_manual( values = c("darkgrey", "#ffd16b", "#80e6ff"))

################
### SALINITY ----
###############
#Quick table showing that pools that were over a certain salinity, 
#but within the accessibility of Femoralis were not occupied.
frog2 <- frog1 %>%
  filter(salinity < 37, 
         height < 72) 

ggplot(frog1, 
       aes(x= KH, y = height, color = species))+
  geom_point()

ggplot(pools_species, 
       aes(x= salinity, y = hardness, color = Species))+
  theme_bw()+  
  ylim(0, 25)+
  xlab("Salinity (ppm)")+
  ylab("Hardness")+
  geom_jitter(alpha = 0.8, size = 3, height = 2)+
  stat_smooth(method = "glm", formula = y ~ (x), fill = "lightgrey")+
  scale_color_manual( values = c("darkgrey", "#ffd16b", "#80e6ff"))

ggplot(pools_species, 
       aes(y = salinity, x = Species))+
  geom_boxplot(width = .1, aes(fill = Species), 
               outlier.shape = NA, alpha = 0.3) +
  geom_flat_violin(aes(fill = Species), 
                   position = position_nudge(x = .2, y = 0),
                   alpha = 0.4) +
  geom_jitter(aes(y = salinity, color = Species), 
              position = position_jitter(width = .15), 
              alpha = 0.6)+
  theme_bw()+
  coord_flip()+
  scale_color_manual( values = c("darkgrey", "#ffd16b", "#80e6ff" ))+
  scale_fill_manual( values = c("darkgrey", "#ffd16b", "#80e6ff"))+
  theme(legend.position = "none")+
  labs(tag = "C")

################
### WATER CAPACITY ----
###############

#ALL
#Water capacity was not significantly correlated with any of the frog species data.

a<-ggplot(frog1, aes(water_capacity, as.numeric(Tad_Y_N)-1, color = species)) +
  geom_point(position=position_jitter(height=0.03, width=0), size = 3,alpha = 0.6) +
  xlab("Water capacity") + 
  ylab("Pr (Tadpole present)")+
  theme_bw()+
  theme(text = element_text(size=13))+
  scale_color_manual( values = c("darkgrey", "#ffd16b", "#80e6ff"), name = "Species")+
  labs(tag = "A")

a

#Terrestrial

b<-ggplot(pool_terr, aes(water_capacity, as.numeric(Tad_Y_N)-1, color = species)) +
  geom_point(position=position_jitter(height=0.03, width=0), size = 3, alpha = 0.6) +
   xlab("Water capacity") + 
   ylab("Pr (Tadpole present)")+
   facet_wrap(~ Water_Cap, scale= "free_x")+
   theme_bw()+
   theme(panel.spacing.x = unit(6, "mm"),
         text = element_text(size=13))+
   scale_color_manual( values = c("darkgrey", "#ffd16b", "#80e6ff"))+
  labs(tag = "A")

b

legend<- get_legend(b)

b<- b + theme(legend.position = "none")

c<- ggplot(pool_terr, 
       aes(x= leaflit_vol_ml, y = height, color =species))+
  geom_point(alpha = 0.6, size = 3)+
  xlab("Leaf litter (vol/mL)")+
  theme_bw()+  
  theme(legend.position = "none")+
  geom_hline(yintercept = 75, linetype = "dashed", color = "darkgrey")+
  ylab("Height (cm)")+
  facet_wrap(~ Water_Cap)+
  scale_color_manual( values = c("darkgrey", "#ffd16b", "#80e6ff"))+
  labs(tag = "B")

grid.arrange(b,legend, c, ncol = 2, widths = c(2.5,0.45))

###################
### PREDICTORS GRAPH ALL----
#######################

kh_high<-
  ggplot(frog2, aes(y = height, x = KH))+
  stat_smooth(method = "glm", formula = y~ (x), aes(x= KH, y = height),
              se = T, fill = "lightgrey", color = "black", fullrange = F)+
  geom_jitter(alpha = 0.8, size = 3, height = 2, aes(shape = species, color = species))+
  theme_bw()+ 
  theme( text = element_text(size=13), legend.position = "none")+
  xlab("KH")+
  ylab("Height (cm)")+
  geom_vline( xintercept = 6.2, linetype = "dashed",
              color = "#ffd16b")+
  geom_vline( xintercept = 6.4, linetype = "dashed",
              color = "darkgrey")+
  ylim(0, 2100)+
  scale_color_manual( values = c("darkgrey", "#ffd16b", "#80e6ff", "black"))+
  scale_shape_manual( values = c(16, 16,16, 1))+
  labs(tag = "A")

kh_high


leaf_pred<- 
  ggplot(frog2, aes(x= leaflit_vol_ml, y = predator_size_sum))+
  stat_smooth(formula = y~ (x), method = "glm", aes(x= leaflit_vol_ml, y = predator_size_sum),
              se = T, fill = "lightgrey", color = "black", fullrange = F, 
              size = 0.8)+
  geom_jitter(alpha = 0.8, size = 3, height = 2, aes(shape = species, color = species))+
  ylim(0, 150)+
  theme_bw()+ 
  theme(text = element_text(size=13), legend.position = "none")+
  geom_vline( xintercept = 1200, linetype = "dashed",
              color = "#80e6ff")+
  geom_vline( xintercept = 50, linetype = "dashed",
              color = "#ffd16b")+
  xlab("Leaf litter (vol/mL)")+
  ylab("Cumulative predator size (sum)")+
  scale_color_manual( values = c("darkgrey", "#ffd16b", "#80e6ff", "black"))+
  scale_shape_manual( values = c(16, 16,16, 1))+
  labs(tag = "B")

leaf_pred

sal_hard<-
  ggplot(frog2, aes(x= salinity, y = hardness))+
  theme_bw()+ 
  theme(text = element_text(size=13))+
  ylim(0, 25)+
  xlab("Salinity (ppm)")+
  ylab("Hardness")+
  stat_smooth(method = "glm", formula = y ~ (x), aes(x= salinity, y = hardness),
              fill = "lightgrey", color = "black")+
  geom_jitter(alpha = 0.8, size = 3, height = 2, aes(shape = species, color = species))+
  geom_vline( xintercept = 240, linetype = "dashed",
              color = "#ffd16b")+
  geom_vline( xintercept = 53, linetype = "dashed",
              color = "darkgrey")+
  scale_color_manual( values = c("darkgrey", "#ffd16b", "#80e6ff", "black"))+
  scale_shape_manual( values = c(16, 16,16, 1))+
  labs(tag = "C")

sal_hard

top<-plot_grid(kh_high, leaf_pred)
plot_grid(top, sal_hard, nrow = 2)

##############################
### PREDICTORS GRAPH TERRESTRIAL SUBSET----
#######################

kh_high_terr<-
  ggplot(pool_terr, 
         aes(x= KH, y = height, color = Species))+
  geom_point(alpha = 0.8)+
  stat_smooth(method = "glm", formula = y~ log(x), 
              se = T, fill = "lightgrey", fullrange = F)+
  theme_bw()+ 
  theme(legend.position = "none")+
  xlab("KH")+
  ylab("Height (cm)")+
  ylim(0, 200)+
  geom_vline( xintercept = 6.2, linetype = "dashed",
              color = "#ffd16b")+
  geom_vline( xintercept = 6.4, linetype = "dashed",
              color = "darkgrey")+
  scale_color_manual( values = c("darkgrey", "#ffd16b", "#80e6ff"))+
  labs(tag = "A")

kh_high_terr


ggplot(pool_terr, 
         aes(x= KH, color = tadpoles_tinc, y = height))+
  geom_point()+
  theme_bw()

ggplot(frog1, 
       aes(color= KH, x = tadpoles_tinc, y = height))+
  geom_point(alpha = 0.8)+
  theme_bw()


leaf_pred_terr<- 
  ggplot(pool_terr, 
         aes(x= leaflit_vol_ml, y = predator_size_sum, color = Species))+
  stat_smooth(formula = y~ (x), method = "glm",
              se = T, fill = "lightgrey", fullrange = F, 
              size = 0.8)+
  geom_point(alpha = 0.8, size = 3)+
  ylim(0, 150)+
  theme_bw()+ 
  theme(legend.position = "none")+
  geom_vline( xintercept = 1200, linetype = "dashed",
              color = "#80e6ff")+
  geom_vline( xintercept = 50, linetype = "dashed",
              color = "#ffd16b")+
  xlab("Leaf litter (vol/mL)")+
  ylab("Cumulative predator size (sum)")+
  scale_color_manual( values = c("darkgrey", "#ffd16b", "#80e6ff"))+
  labs(tag = "B")

leaf_pred_terr

sal_hard_terr<-
  ggplot(pool_terr, 
         aes(x= salinity, y = hardness, color = Species))+
  theme_bw()+  
  ylim(0, 25)+
  xlab("Salinity (ppm)")+
  ylab("Hardness")+
  geom_jitter(alpha = 0.8, size = 3, height = 2)+
  stat_smooth(method = "glm", formula = y ~ (x), fill = "lightgrey")+
  geom_vline( xintercept = 240, linetype = "dashed",
              color = "#ffd16b")+
  geom_vline( xintercept = 53, linetype = "dashed",
              color = "darkgrey")+
  scale_color_manual( values = c("darkgrey", "#ffd16b", "#80e6ff"))+
  labs(tag = "C")

sal_hard_terr

leaf_salt_terr<-
  ggplot(pool_terr,
         aes(y= salinity, x = leaflit_vol_ml))+
  theme_bw()+  
  ylim(0, 65)+
  ylab ("Salinity (ppm)") + 
  xlab ("Leaf litter (vol/mL)")+
  geom_hline( yintercept  = 40, linetype = "dashed")+
  geom_jitter(alpha = 0.8, size = 3, height = 2)+
  scale_color_manual( values = c("darkgrey", "#ffd16b", "#80e6ff"))


leaf_salt_terr

?geom_hline


###ANDRIUS REQUESTS----

library(ggplot2)
library(png)
library(grid)
library(ggimage)

img <- readPNG("tree.png")
i2 <- grid::rasterGrob(img, interpolate = T)

ggplot(pools_species, 
       aes(y = height, x = Species))+
  geom_flat_violin(aes(fill = Species), 
                   position = position_nudge(x = .2, y = 0),
                   alpha = 0.4)+
  geom_point(aes(y = height, color = Species), 
             position = position_jitter(width = .15), 
             alpha = 0.6)+
  theme_bw()+
  expand_limits(x = 3.75) +
  scale_color_manual( values = c("darkgrey", "#ffd16b", "#80e6ff" ))+
  scale_fill_manual( values = c("darkgrey", "#ffd16b", "#80e6ff"))+
  scale_y_continuous(position = "right")+
  ylab("Height (cm)")+
  theme(text = element_text(size=14), legend.position = "none")+
  annotation_custom(rasterGrob(img, 
                               width = unit(1,"npc"),
                               height = unit(1,"npc")), 
                     -0.05, 1.75, 0, 1800)+ #xmin, #xmax, #ymin, #ymax
  coord_cartesian(clip = "off")

